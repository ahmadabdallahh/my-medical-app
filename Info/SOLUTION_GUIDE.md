# ๐ง ุฏููู ุญู ูุดุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

# Database Issues Solution Guide

## ๐ ุงููุดุงูู ุงููุญุฏุฏุฉ

1. **ุนููุฏ 'type' ููููุฏ** ูู ุฌุฏูู ุงููุณุชุดููุงุช
2. **ุนููุฏ 'email' ููููุฏ** ูู ุฌุฏูู ุงูุนูุงุฏุงุช
3. **ุฏุงูุฉ get_logged_in_user** ุบูุฑ ูุชููุนุฉ
4. **ูุง ุชูุฌุฏ ุจูุงูุงุช** ูู ุงูุฌุฏุงูู

## ๐ ุงูุญู ุงูุดุงูู

### ุงูุฎุทูุฉ ุงูุฃููู: ุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### ุงูุทุฑููุฉ ุงูุฃููู: ุงุณุชุฎุฏุงู ููู ุงูุฅุตูุงุญ ุงูุดุงูู (ูููุตู ุจู)

```bash
# 1. ุชุฃูุฏ ูู ุชุดุบูู ุฎุงุฏู MySQL
# 2. ููุฐ ููู ุงูุฅุตูุงุญ ุงูุดุงูู
mysql -u root -p < fix_database.sql
```

#### ุงูุทุฑููุฉ ุงูุซุงููุฉ: ุงูุฅุตูุงุญ ุงููุฏูู

```sql
-- 1. ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช
CREATE DATABASE IF NOT EXISTS medical_booking CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE medical_booking;

-- 2. ุฅุถุงูุฉ ุงูุฃุนูุฏุฉ ุงูููููุฏุฉ ูุฌุฏูู ุงููุณุชุดููุงุช
ALTER TABLE hospitals
ADD COLUMN type ENUM('ุญูููู', 'ุฎุงุต') DEFAULT 'ุญูููู' AFTER image,
ADD COLUMN is_24h BOOLEAN DEFAULT FALSE AFTER rating;

-- 3. ุฅุถุงูุฉ ุงูุฃุนูุฏุฉ ุงูููููุฏุฉ ูุฌุฏูู ุงูุนูุงุฏุงุช
ALTER TABLE clinics
ADD COLUMN email VARCHAR(100) AFTER phone,
ADD COLUMN consultation_fee DECIMAL(10,2) DEFAULT 0.00 AFTER image;

-- 4. ุฅุฏุฑุงุฌ ุงูุจูุงูุงุช
-- (ุงุณุชุฎุฏู ูุญุชูู fake_data.sql)
```

### ุงูุฎุทูุฉ ุงูุซุงููุฉ: ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ

```bash
# ุงูุชุญ ุงููุชุตูุญ ูุงุฐูุจ ุฅูู:
http://localhost/App-Demo/test_database_fix.php
```

### ุงูุฎุทูุฉ ุงูุซุงูุซุฉ: ุงูุชุญูู ูู ุงููุชุงุฆุฌ

ูุฌุจ ุฃู ุชุธูุฑ ุงููุชุงุฆุฌ ุงูุชุงููุฉ:

- โ ูุฌุญ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุฌููุน ุงูุฌุฏุงูู ููุฌูุฏุฉ
- โ ุฌููุน ุงูุฃุนูุฏุฉ ุงููุทููุจุฉ ููุฌูุฏุฉ
- โ ุฏุงูุฉ get_logged_in_user ููุฌูุฏุฉ
- โ ุงูุจูุงูุงุช ููุฌูุฏุฉ ูู ุฌููุน ุงูุฌุฏุงูู

## ๐ ุงูุจูุงูุงุช ุงููุชููุนุฉ

ุจุนุฏ ุงูุฅุตูุงุญุ ูุฌุจ ุฃู ุชุญุชูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุนูู:

| ุงูุฌุฏูู            | ุนุฏุฏ ุงูุณุฌูุงุช |
| ----------------- | ----------- |
| ุงูุชุฎุตุตุงุช ุงูุทุจูุฉ   | 20          |
| ุงููุณุชุดููุงุช        | 15          |
| ุงูุนูุงุฏุงุช          | 45+         |
| ุงูุฃุทุจุงุก           | 30+         |
| ุฃููุงุช ุนูู ุงูุฃุทุจุงุก | 150+        |

## ๐ ุงุฎุชุจุงุฑ ุงููุธุงุฆู

### ุงุฎุชุจุงุฑ ุฏุงูุฉ get_logged_in_user

```php
// ุชุฃูุฏ ูู ูุฌูุฏ ุงูุฏุงูุฉ
if (function_exists('get_logged_in_user')) {
    echo "โ ุงูุฏุงูุฉ ููุฌูุฏุฉ";
} else {
    echo "โ ุงูุฏุงูุฉ ููููุฏุฉ";
}
```

### ุงุฎุชุจุงุฑ ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ

```sql
-- ุงุฎุชุจุงุฑ ุนููุฏ type ูู ุฌุฏูู ุงููุณุชุดููุงุช
DESCRIBE hospitals;

-- ุงุฎุชุจุงุฑ ุนููุฏ email ูู ุฌุฏูู ุงูุนูุงุฏุงุช
DESCRIBE clinics;
```

## ๐๏ธ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ูุดููุฉ 1: ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช

```bash
# ุชุฃูุฏ ูู ุชุดุบูู MySQL
sudo service mysql start  # Linux
# ุฃู
net start mysql           # Windows
```

### ูุดููุฉ 2: ุฎุทุฃ ูู ุงูุตูุงุญูุงุช

```sql
-- ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ ูุน ุตูุงุญูุงุช ูุงููุฉ
CREATE USER 'medical_user'@'localhost' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON medical_booking.* TO 'medical_user'@'localhost';
FLUSH PRIVILEGES;
```

### ูุดููุฉ 3: ุฎุทุฃ ูู ุงูุชุฑููุฒ

```sql
-- ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู UTF-8
ALTER DATABASE medical_booking CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

## ๐ ุงููููุงุช ุงููุทููุจุฉ

1. **fix_database.sql** - ููู ุงูุฅุตูุงุญ ุงูุดุงูู
2. **test_database_fix.php** - ููู ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ
3. **config/database.php** - ุฅุนุฏุงุฏุงุช ุงูุงุชุตุงู
4. **includes/functions.php** - ุงููุธุงุฆู ุงูุฃุณุงุณูุฉ

## ๐ ุฑูุงุจุท ุงูุงุฎุชุจุงุฑ

ุจุนุฏ ุงูุฅุตูุงุญุ ุงุฎุชุจุฑ ุงูุฑูุงุจุท ุงูุชุงููุฉ:

- **ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ:** `http://localhost/App-Demo/index.php`
- **ุตูุญุฉ ุงููุณุชุดููุงุช:** `http://localhost/App-Demo/hospitals.php`
- **ุตูุญุฉ ุงูุชุณุฌูู:** `http://localhost/App-Demo/register.php`
- **ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู:** `http://localhost/App-Demo/login.php`
- **ุงุฎุชุจุงุฑ ุดุงูู:** `http://localhost/App-Demo/test_all_features.php`

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ุงููุณุฎ ุงูุงุญุชูุงุทู:** ุงุญุชูุธ ุจูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจู ุงูุฅุตูุงุญ
2. **ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ:** ุณูุชู ุญุฐู ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ุนูุฏ ุงุณุชุฎุฏุงู `fix_database.sql`
3. **ุงูุตูุงุญูุงุช:** ุชุฃูุฏ ูู ูุฌูุฏ ุตูุงุญูุงุช ูุงููุฉ ููุงุนุฏุฉ ุงูุจูุงูุงุช
4. **ุงูุชุฑููุฒ:** ุงุณุชุฎุฏู UTF-8 ูุถูุงู ุนุฑุถ ุงููุตูุต ุงูุนุฑุจูุฉ ุจุดูู ุตุญูุญ

## ๐ฏ ุงููุชูุฌุฉ ุงููุชููุนุฉ

ุจุนุฏ ุชุทุจูู ุงูุญูุ ูุฌุจ ุฃู ูุนูู ุงููุธุงู ุจุดูู ูุงูู ูุน:

- โ ุนุฑุถ ุงููุณุชุดููุงุช ูุน ููุนูุง (ุญูููู/ุฎุงุต)
- โ ุนุฑุถ ุงูุนูุงุฏุงุช ูุน ุฑุณูู ุงูุงุณุชุดุงุฑุฉ
- โ ุชุณุฌูู ุงูุฏุฎูู ูุงูุฎุฑูุฌ
- โ ุญุฌุฒ ุงูููุงุนูุฏ
- โ ุนุฑุถ ุฃููุงุช ุนูู ุงูุฃุทุจุงุก

## ๐ ุงูุฏุนู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดุงูู:

1. ุฑุงุฌุน ุฑุณุงุฆู ุงูุฎุทุฃ ูู `test_database_fix.php`
2. ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช `config/database.php`
3. ุชุญูู ูู ุชุดุบูู ุฎุงุฏู MySQL
4. ุฑุงุฌุน ููู `ERROR_HANDLING_GUIDE.md`
